# V4.0 Mission Control & Interactive Simulation

## Overview
Release V4.0.0 transforms the project from a headless Python simulation into a modern, interactive web-based platform. This "Mission Control" interface allows users to visualize telemetry in 3D, monitor system health, and dynamically design missions without restarting the application.

## System Architecture

### 1. Frontend (`ui/`)
- **Framework**: React 18 + Vite
- **3D Engine**: React Three Fiber (Three.js wrapper)
- **Styling**: Tailwind CSS
- **State**: Websocket-driven real-time updates (60Hz)

### 2. Backend (`src/satellite_control/dashboard/`)
- **Server**: FastAPI (Python)
- **Protocol**: WebSockets for telemetry, REST for configuration
- **Integration**: Wraps the C++ `SatelliteMPCLinearizedSimulation` engine

---

## New Features

### üñ•Ô∏è Mission Control UI
A unified dashboard replacing the legacy Matplotlib plots and Mujoco viewer.
- **3D Viewport**: Renders the Satellite, Earth/Target, and Obstacles with orbit controls.
- **Grid Telemetry Overlay**: 
  - Precision-aligned grid layout.
  - Displays **Position** (m), **Velocity** (m/s), **Rotation** (Roll/Pitch/Yaw in ¬∞), and **Spin Rate** (Angular Velocity in ¬∞/s).
  - Uses explicit `+` signs for alignment of positive/negative values.
- **Actuator Diagnostics**: 
  - Centralized panel showing both **Thrusters** (orange) and **Reaction Wheels** (green).
  - Includes numeric readouts for exact Thrust/Torque values.
  
### üõ†Ô∏è Interactive Mission Editor
A config-driven editor accessible via the UI sidebar.
- **Parametric Design**: Modify start positions and target locations.
- **Obstacle Management**: Add/Remove/Edit spherical obstacles to test collision avoidance.
- **Hot-Reload**: The "Run Simulation" button instantly re-initializes the backend physics engine with the new parameters.

### üì° REST API
The simulation is now controllable programmatically via HTTP.

#### `POST /mission`
Updates the current mission configuration and restarts the simulation loop.

**Payload:**
```json
{
  "start_position": [10.0, 0.0, 0.0],
  "obstacles": [
    {
      "position": [5.0, 0.0, 0.0],
      "radius": 1.5
    }
  ]
}
```

---

## Technical Fixes & Improvements (Phase 6)
- **Visualization**: Fixed Euler Angle order mismatch (switched to ZYX intrinsic) to correctly visualize Roll/Pitch/Yaw.
- **Backend**: Patched `app.py` telemetry slicing to dynamically handle 6 vs 12 thruster configurations, fixing missing Reaction Wheel data.
- **Tuning**: Adjusted `MPC_PREDICTION_HORIZON` to 100 (from 150) for optimized performance.

---

## Setup & Usage

### Prerequisites
- Node.js 18+
- Python 3.9+

### Installation
```bash
# Backend
pip install -r requirements.txt

# Frontend
cd ui
npm install
```

### Running the System
We generally run this in two separate terminals.

**Terminal 1 (Backend):**
```bash
python run_dashboard.py
```
*Listens on http://0.0.0.0:8000*

**Terminal 2 (Frontend):**
```bash
cd ui
npm run dev
```
*Accessible at http://localhost:5173*

## Verification
The system has been verified to support:
1. **High-Frequency Telemetry**: Smooth 60fps rendering of 50ms control steps.
2. **Dynamic Reconfiguration**: Changing obstacle positions in the UI correctly updates the MPC constraints in the next simulation run.
3. **Collision Avoidance**: Visual verification of the satellite deviating around user-placed obstacles.
4. **Actuator Fidelity**: Visual confirmation of Reaction Wheel torque activation during purely rotational maneuvers.
